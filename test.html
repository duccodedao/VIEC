<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Gửi 0.005 TON để nhận 1000 Jetton</title>
  <script src="https://unpkg.com/@tonconnect/sdk@latest"></script>
</head>
<body>
  <h2>Gửi 0.005 TON để nhận 1000 token VIEC</h2>

  <button id="connect">Kết nối ví</button>
  <div id="status"></div>

  <button id="send" disabled>Gửi 0.005 TON</button>

  <script>
    const connector = new TonConnect();
    const myWallet = "EQCvxJy4eG8hyHBFsZ7eePxrRsUQSFE_jpptRAYBmcG_DOGS"; // ví nhận TON
    const sendAmount = "5000000"; // 0.005 TON = 5,000,000 nanotons

    let userAddress = null;

    document.getElementById("connect").onclick = async () => {
      try {
        await connector.restoreConnection();
        const wallet = await connector.connectWallet();
        userAddress = wallet.account.address;
        document.getElementById("status").innerText = "Đã kết nối ví: " + userAddress;
        document.getElementById("send").disabled = false;
      } catch (err) {
        alert("Không thể kết nối ví.");
      }
    };

    document.getElementById("send").onclick = async () => {
      if (!userAddress) {
        alert("Hãy kết nối ví trước.");
        return;
      }

      const tx = {
        validUntil: Math.floor(Date.now() / 1000) + 600,
        messages: [
          {
            address: myWallet,
            amount: sendAmount,
            payload: "", // payload rỗng
          }
        ]
      };

      try {
        await connector.sendTransaction(tx);
        alert("Giao dịch gửi 0.005 TON thành công!\nBạn sẽ nhận được 1000 token VIEC sau vài giây.");
      } catch (err) {
        console.error(err);
        alert("Lỗi gửi giao dịch.");
      }
    };
  </script>
</body>
</html>
